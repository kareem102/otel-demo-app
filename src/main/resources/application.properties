spring.application.name=otel-demo
logging.level.root=INFO
logging.level.com.shahidyousuf.otel_demo=DEBUG
spring.output.ansi.enabled=never
spring.main.banner-mode=off

# Expose key actuator endpoints during development
management.endpoints.web.exposure.include=health,info,metrics

# Load local environment overrides from .env (not committed)
spring.config.import=optional:file:.env[.properties]

# Micrometer OTLP metrics export to Grafana Cloud (testing only; contains secrets)
management.otlp.metrics.export.enabled=true
management.otlp.metrics.export.url=${GRAFANA_OTLP_METRICS_URL:${GRAFANA_OTLP_GATEWAY_URL}}
management.otlp.metrics.export.step=10s
management.otlp.metrics.export.connect-timeout=5s
management.otlp.metrics.export.read-timeout=10s
management.otlp.metrics.export.resource-attributes=service.name=${spring.application.name},service.version=${project.version:0.0.1}
management.otlp.metrics.export.temporality=CUMULATIVE

# Global metric tags and useful histograms for HTTP timers
management.metrics.tags.service=${spring.application.name}
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.percentiles-histogram.hello.latency=true
management.metrics.distribution.percentiles-histogram.work.latency=true

## Logging: keep defaults; no verbose OTLP debug in prod

# Micrometer OTLP auth header from .env; keep both forms for relaxed binding
management.otlp.metrics.export.headers[Authorization]=${GRAFANA_OTLP_HEADERS_AUTHORIZATION:Bearer ${GRAFANA_OTLP_TOKEN:}}
management.otlp.metrics.export.headers.Authorization=${GRAFANA_OTLP_HEADERS_AUTHORIZATION:Bearer ${GRAFANA_OTLP_TOKEN:}}

# Back-compat properties (some environments bind this prefix)
management.metrics.export.otlp.enabled=true
management.metrics.export.otlp.url=${GRAFANA_OTLP_METRICS_URL:${GRAFANA_OTLP_GATEWAY_URL}}
management.metrics.export.otlp.step=10s
management.metrics.export.otlp.headers[Authorization]=${GRAFANA_OTLP_HEADERS_AUTHORIZATION:Bearer ${GRAFANA_OTLP_TOKEN:}}
management.metrics.export.otlp.temporality=CUMULATIVE

# Use default server.port (8080)

# Disable SimpleMeterRegistry so we can clearly see OTLP activity
management.simple.metrics.export.enabled=false

# Compatibility: some Spring Boot builds also honor this flag
management.metrics.export.otlp.enabled=true
